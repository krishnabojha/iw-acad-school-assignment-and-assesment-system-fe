{"ast":null,"code":"var _jsxFileName = \"D:\\\\Insight_workshop\\\\Django_React_project\\\\final project(React)\\\\final-project-react\\\\src\\\\Authentication\\\\Userdata.js\";\nimport React, { Component } from 'react';\nimport ShowClassItem from './ShowClassItem';\nimport './CreateClassForm.css'; // import { Redirect } from 'react-router'\n// import { createHashHistory } from 'history'\n\nexport default class Userdata extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      emailStored: false,\n      obj: [],\n      usertoken: [],\n      createClass: false,\n      userobj: [],\n      createbtn: 'Create Class',\n      newclassname: '',\n      inClassroom: false,\n      classid: ''\n    };\n\n    this.onHandleSubmit = () => {\n      //creating a new classroom\n      const newclass = new FormData();\n      newclass.append('classname', this.state.newclassname);\n      newclass.append('email', localStorage.getItem('email'));\n      fetch('http://127.0.0.1:8000/data/studymaterial_class_create/', {\n        method: 'POST',\n        body: newclass\n      }).then(response => response.json()).then(result => {\n        console.log('success: created class', result);\n        fetch('http://127.0.0.1:8000/data/myclasses_create/', {\n          method: 'POST',\n          body: {\n            \"classroom_id\": result.id,\n            \"user_id\": usertoken[0].user_id\n          }\n        });\n      }).catch(error => {\n        console.log('error: ', error);\n      });\n    };\n\n    this.onLogout = () => {\n      localStorage.removeItem('token');\n      localStorage.removeItem('email');\n      window.location.reload();\n    };\n\n    this.onCreateClass = () => {\n      if (this.state.createClass === false) {\n        this.setState({\n          createClass: true,\n          createbtn: 'Submit'\n        });\n      } else if (this.state.createClass === true && this.state.newclassname === '') {\n        this.setState({\n          createClass: false,\n          createbtn: 'Create Class'\n        });\n      } else {\n        this.setState({\n          createClass: false,\n          createbtn: 'Create Class'\n        });\n        this.onHandleSubmit();\n        window.location.reload();\n      }\n    };\n\n    this.onChangeInput = event => {\n      this.setState({\n        [event.target.name]: event.target.value\n      });\n    };\n\n    this.onEnterRoom = id => {\n      this.setState({\n        inClassroom: true,\n        classid: id\n      });\n    };\n\n    this.onGoBack = () => {\n      window.location.reload();\n    };\n  }\n\n  async componentDidMount() {\n    //fetching token to get user_id\n    await fetch('http://127.0.0.1:8000/user/token/', {\n      method: 'GET'\n    }).then(response => response.json()).then(result => {\n      console.log('this is result : ', result);\n      this.setState({\n        usertoken: result.filter(function (item) {\n          return item.key === localStorage.getItem('token');\n        })\n      });\n    }); //fetching users to get email\n\n    if (this.state.emailStored === false) {\n      await fetch('http://127.0.0.1:8000/user/list/', {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': 'Token ' + localStorage.getItem('token')\n        }\n      }).then(respone => respone.json()).then(result => {\n        const {\n          usertoken\n        } = this.state;\n        console.log('this is result: before', usertoken[0].user_id);\n\n        if (usertoken[0] === undefined) {\n          window.location.reload();\n        }\n\n        this.setState({\n          userobj: result.filter(function (item) {\n            return item.id === usertoken[0]['user_id'];\n          })\n        });\n        console.log('this is user email', this.state.userobj[0].email); /// storing the email to the local storage\n\n        localStorage.setItem('email', this.state.userobj[0].email);\n      });\n      this.setState({\n        emailStored: true\n      });\n      console.log('this is emailstored: ', this.state.emailStored);\n    } //this is to get class from many to many table\n\n\n    const studentuser = await fetch('http://127.0.0.1:8000/data/myclasses_list/' + usertoken[0].user_id);\n    const userjson = await studentuser.json();\n    console.log('classes related to user id 1', userjson);\n    this.setState({\n      obj: userjson\n    }); // fetching class room to get class room of logged in user \n    // await fetch('http://127.0.0.1:8000/data/studymaterial_class_list/',{\n    //     method: 'GET',\n    //     headers: {\n    //         'Content-Type': 'application/json',\n    //         'Authorization': 'Token '+localStorage.getItem('token')\n    //     },\n    // }).then((respone)=>respone.json())\n    // .then(result =>{\n    //     console.log('obj result',result)\n    //     if (localStorage.getItem('email') === null){\n    //         window.location.reload()\n    //     }\n    //     this.setState({\n    //         obj: result.filter(function(value){return value.email === localStorage.getItem('email')})\n    //     })\n    // })\n\n    console.log('Token ', localStorage.getItem('token'));\n    console.log('this is email haha', localStorage.getItem('email'));\n  }\n\n  render() {\n    const abc = this.onEnterRoom;\n    console.log('this is obj: ', this.state.obj);\n    const {\n      newclassname\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"side-bar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 18\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"top-bar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 17\n      }\n    }, this.state.inClassroom === true ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"back-arrow\",\n      title: \"goto back\",\n      onClick: this.onGoBack,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: \"https://img.icons8.com/fluent//000000/left.png\",\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 25\n      }\n    })) : /*#__PURE__*/React.createElement(\"h3\", {\n      className: \"class-title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 22\n      }\n    }, \"My Class Room\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"logout-btn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      onClick: this.onCreateClass,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 21\n      }\n    }, this.state.createbtn), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.onLogout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 21\n      }\n    }, \"Logout\")), this.state.createClass === true ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"create-class-form\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      name: \"newclassname\",\n      value: newclassname,\n      placeholder: \"Enter name of new Class\",\n      required: true,\n      onChange: this.onChangeInput,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 29\n      }\n    })) : /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 27\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"classes-div\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 17\n      }\n    }, this.state.inClassroom === false ? this.state.obj.map(function (item) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"single-class\",\n        key: item.id,\n        onClick: abc.bind(this, item.id),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"h3\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 26\n        }\n      }, item.classname), /*#__PURE__*/React.createElement(\"h3\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 25\n        }\n      }, item.email));\n    }) : /*#__PURE__*/React.createElement(ShowClassItem, {\n      classid: this.state.classid,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 23\n      }\n    })));\n  }\n\n}","map":{"version":3,"sources":["D:/Insight_workshop/Django_React_project/final project(React)/final-project-react/src/Authentication/Userdata.js"],"names":["React","Component","ShowClassItem","Userdata","state","emailStored","obj","usertoken","createClass","userobj","createbtn","newclassname","inClassroom","classid","onHandleSubmit","newclass","FormData","append","localStorage","getItem","fetch","method","body","then","response","json","result","console","log","id","user_id","catch","error","onLogout","removeItem","window","location","reload","onCreateClass","setState","onChangeInput","event","target","name","value","onEnterRoom","onGoBack","componentDidMount","filter","item","key","headers","respone","undefined","email","setItem","studentuser","userjson","render","abc","map","bind","classname"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport ShowClassItem from './ShowClassItem'\r\nimport './CreateClassForm.css'\r\n// import { Redirect } from 'react-router'\r\n// import { createHashHistory } from 'history'\r\n\r\nexport default class Userdata extends Component {\r\n    state = {\r\n        emailStored: false,\r\n        obj:[],\r\n        usertoken:[],\r\n        createClass:false,\r\n        userobj: [],\r\n        createbtn: 'Create Class',\r\n        newclassname:'',\r\n        inClassroom: false,\r\n        classid:'',\r\n    }\r\n    async componentDidMount() {\r\n        //fetching token to get user_id\r\n        await fetch('http://127.0.0.1:8000/user/token/',{\r\n            method: 'GET'\r\n        }).then(response => response.json())\r\n        .then(result => {\r\n            console.log('this is result : ', result)\r\n            this.setState({\r\n                usertoken: result.filter(function(item){return item.key === localStorage.getItem('token')}),\r\n            })\r\n        })\r\n       \r\n        //fetching users to get email\r\n        if (this.state.emailStored === false) {\r\n            await fetch('http://127.0.0.1:8000/user/list/',{\r\n            method: 'GET',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': 'Token '+localStorage.getItem('token')\r\n            },\r\n        }).then((respone)=>respone.json())\r\n        .then(result =>{\r\n            const {usertoken} = this.state\r\n            console.log('this is result: before',usertoken[0].user_id)\r\n            if (usertoken[0] === undefined){\r\n                window.location.reload()\r\n            }\r\n            this.setState({\r\n                userobj: result.filter(function(item){return item.id === usertoken[0]['user_id']})\r\n            })\r\n            console.log('this is user email', this.state.userobj[0].email)\r\n            /// storing the email to the local storage\r\n            localStorage.setItem('email',this.state.userobj[0].email)\r\n        })\r\n        this.setState({\r\n            emailStored: true\r\n        })\r\n        console.log('this is emailstored: ',this.state.emailStored)\r\n        }\r\n        //this is to get class from many to many table\r\n        const studentuser = await fetch('http://127.0.0.1:8000/data/myclasses_list/'+usertoken[0].user_id)\r\n        const userjson = await studentuser.json()\r\n        console.log('classes related to user id 1', userjson)\r\n        this.setState({\r\n            obj: userjson\r\n        })\r\n        // fetching class room to get class room of logged in user \r\n        // await fetch('http://127.0.0.1:8000/data/studymaterial_class_list/',{\r\n        //     method: 'GET',\r\n        //     headers: {\r\n        //         'Content-Type': 'application/json',\r\n        //         'Authorization': 'Token '+localStorage.getItem('token')\r\n        //     },\r\n        // }).then((respone)=>respone.json())\r\n        // .then(result =>{\r\n        //     console.log('obj result',result)\r\n        //     if (localStorage.getItem('email') === null){\r\n        //         window.location.reload()\r\n        //     }\r\n        //     this.setState({\r\n        //         obj: result.filter(function(value){return value.email === localStorage.getItem('email')})\r\n        //     })\r\n        // })\r\n        \r\n        console.log('Token ', localStorage.getItem('token'))\r\n        console.log('this is email haha', localStorage.getItem('email'))\r\n    }\r\n    onHandleSubmit=()=>{\r\n        //creating a new classroom\r\n        const newclass = new FormData()\r\n        newclass.append('classname', this.state.newclassname)\r\n        newclass.append('email', localStorage.getItem('email'))\r\n        fetch('http://127.0.0.1:8000/data/studymaterial_class_create/',{\r\n            method: 'POST',\r\n            body:newclass\r\n        }).then(response => response.json())\r\n        .then(result =>{\r\n            console.log('success: created class',result)\r\n            \r\n            fetch('http://127.0.0.1:8000/data/myclasses_create/',{\r\n                method: 'POST',\r\n                body:{\r\n                    \"classroom_id\": result.id,\r\n                    \"user_id\": usertoken[0].user_id\r\n                }\r\n            })\r\n        })\r\n        .catch(error=>{\r\n            console.log('error: ',error)\r\n        })\r\n    }\r\n    onLogout =()=>{\r\n        localStorage.removeItem('token')\r\n        localStorage.removeItem('email')\r\n        window.location.reload();\r\n    }\r\n    onCreateClass =()=>{\r\n        if(this.state.createClass === false){\r\n            this.setState({\r\n                createClass: true,\r\n                createbtn: 'Submit'\r\n            })\r\n        }\r\n        else if (this.state.createClass === true && this.state.newclassname === ''){\r\n            this.setState({\r\n                createClass: false,\r\n                createbtn: 'Create Class'\r\n            })\r\n        }\r\n        else{\r\n            this.setState({\r\n                createClass: false,\r\n                createbtn: 'Create Class'\r\n            })\r\n            this.onHandleSubmit()\r\n            window.location.reload()\r\n        }\r\n    }\r\n    onChangeInput =(event)=>{\r\n        this.setState({\r\n            [event.target.name]: event.target.value\r\n        })\r\n    }\r\n    onEnterRoom =(id)=> {\r\n        this.setState({\r\n            inClassroom: true,\r\n            classid:id\r\n        })\r\n    }\r\n    onGoBack =()=>{\r\n        window.location.reload()\r\n    }\r\n    render() {\r\n        const abc = this.onEnterRoom\r\n        console.log('this is obj: ', this.state.obj)\r\n        const {newclassname} = this.state\r\n        return (\r\n            <div>\r\n                 {/* side bar */}\r\n                 <div className = \"side-bar\">\r\n                    \r\n                </div>\r\n                <div className = 'top-bar'>\r\n                {   \r\n                (this.state.inClassroom === true)?\r\n                    <div className = 'back-arrow' title = 'goto back' onClick = {this.onGoBack}>\r\n                        <img src=\"https://img.icons8.com/fluent//000000/left.png\" alt = ''/>               \r\n                    </div>\r\n                    :<h3 className = 'class-title'>My Class Room</h3>\r\n                \r\n                }\r\n                \r\n                <div className = 'logout-btn'>\r\n                    <button type = 'submit' onClick = {this.onCreateClass}>{this.state.createbtn}</button>\r\n                    <button onClick = {this.onLogout}>Logout</button>\r\n                </div>\r\n\r\n                {\r\n                        (this.state.createClass === true)?\r\n                        <div className = 'create-class-form'>\r\n                            <input type = 'text' name = 'newclassname' value = {newclassname} placeholder = 'Enter name of new Class' required onChange = {this.onChangeInput}></input>\r\n                        </div>\r\n                        : <p></p>\r\n                    }\r\n                \r\n                </div>\r\n\r\n                <div className = \"classes-div\">\r\n                {  \r\n                (this.state.inClassroom === false)?\r\n                    this.state.obj.map(function(item){\r\n                        return (<div className = \"single-class\" key = {item.id} onClick = {abc.bind(this,  item.id)}>\r\n                         <h3>{item.classname}</h3>\r\n                        <h3>{item.email}</h3>\r\n                        </div>)\r\n                    })\r\n                    : <ShowClassItem classid = {this.state.classid}></ShowClassItem>\r\n                }\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}